import { computed, ref } from 'vue'

const storedLocale = typeof window === 'undefined' ? null : localStorage.getItem('locale')
const locale = ref(storedLocale || 'en')

const messages = {
  en: {
    nav: {
      home: 'Home',
      products: 'Products',
      cart: 'Cart',
      orders: 'Orders',
      profile: 'Profile',
      addresses: 'Addresses',
      admin: 'Admin',
      adminUsers: 'Users',
      adminRoles: 'Roles',
      adminProducts: 'Products',
      adminCategories: 'Categories',
      adminOrders: 'Orders',
      adminBanners: 'Banners',
      adminCarts: 'Carts',
      adminStats: 'Stats',
      signIn: 'Sign in',
      createAccount: 'Create account',
      signOut: 'Sign out',
      signedIn: 'Signed in',
    },
    common: {
      loading: 'Loading...',
      empty: 'No data',
      search: 'Search',
      reset: 'Reset',
      save: 'Save',
      cancel: 'Cancel',
      create: 'Create',
      createdAt: 'Created',
      delete: 'Delete',
      edit: 'Edit',
      submit: 'Submit',
      total: 'Total',
      manage: 'Manage',
      status: 'Status',
      actions: 'Actions',
      price: 'Price',
      qty: 'Qty',
      amount: 'Amount',
      yes: 'Yes',
      no: 'No',
      refresh: 'Refresh',
    },
    home: {
      discover: 'Discover',
      heroTitle: 'Shop smarter, live lighter',
      heroSubtitle: 'Curated categories, fast checkout, and smooth payments.',
      browse: 'Browse products',
      viewRecommend: 'View picks',
      tags: {
        fast: 'Fast delivery',
        secure: 'Secure payment',
        curated: 'Curated picks',
      },
      bannerTitle: 'Spotlight',
      noBanners: 'No banners',
      categories: 'Categories',
      allCategories: 'All categories',
      categoryHint: 'Curated themes · Quick browse',
      recommended: 'Recommended',
      viewAll: 'View all',
      view: 'View',
    },
    productList: {
      title: 'Product discovery',
      subtitle: 'Filter by category and keywords to find the best match.',
      searchPlaceholder: 'Search keywords',
      categoryPlaceholder: 'Choose category',
      stock: 'Stock',
      noProducts: 'No products',
    },
    productDetail: {
      title: 'Product detail',
      price: 'Price',
      stock: 'Stock',
      quantity: 'Quantity',
      addToCart: 'Add to cart',
      addFavorite: 'Add to favorites',
      favorited: 'Added to favorites',
      back: 'Back',
      description: 'Description',
    },
    cart: {
      title: 'Shopping cart',
      subtitle: 'Review items before checkout.',
      empty: 'Cart is empty',
      checkout: 'Checkout',
      remove: 'Remove',
      quantity: 'Quantity',
      selectedTotal: 'Selected total',
      added: 'Added to cart',
      addFail: 'Failed to add to cart',
      loadFail: 'Failed to load cart',
      updateFail: 'Failed to update cart',
      removeSuccess: 'Removed',
      removeFail: 'Failed to remove item',
    },
    address: {
      title: 'Shipping addresses',
      manage: 'Manage recipient details',
      add: 'Add address',
      receiver: 'Receiver',
      phone: 'Phone',
      province: 'Province',
      city: 'City',
      area: 'Area',
      detail: 'Detail',
      default: 'Default',
      save: 'Save',
      delete: 'Delete',
      setDefault: 'Set default',
      empty: 'No addresses',
    },
    orderConfirm: {
      title: 'Order confirmation',
      subtitle: 'Review items, choose address, and submit.',
      items: 'Items',
      address: 'Shipping address',
      manageAddress: 'Manage addresses',
      total: 'Total',
      submit: 'Submit order',
      noItems: 'No items selected',
      selectAddress: 'Please select a shipping address',
      created: 'Order created',
      submitFail: 'Failed to submit order',
      loadFail: 'Failed to load order confirmation',
    },
    orderList: {
      title: 'My orders',
      subtitle: 'Track status and actions.',
      orderNo: 'Order No',
      statusAll: 'All',
      pending: 'Pending payment',
      paid: 'Paid',
      shipped: 'Shipped',
      completed: 'Completed',
      pay: 'Pay',
      confirm: 'Confirm receipt',
      noOrders: 'No orders',
      payConfirm: 'Confirm payment now?',
      confirmConfirm: 'Confirm receipt of this order?',
      paySuccess: 'Payment successful',
      payFail: 'Payment failed',
      confirmSuccess: 'Order completed',
      confirmFail: 'Confirmation failed',
      loadFail: 'Failed to load orders',
    },
    auth: {
      loginTitle: 'Sign in',
      loginSubtitle: 'Welcome back. Please enter your credentials.',
      registerTitle: 'Create account',
      registerSubtitle: 'Start your shopping journey.',
      username: 'Username',
      phone: 'Phone',
      password: 'Password',
      confirmPassword: 'Confirm password',
      login: 'Sign in',
      register: 'Create account',
      noAccount: 'No account?',
      hasAccount: 'Already have an account?',
      toRegister: 'Create account',
      toLogin: 'Back to sign in',
      loginSuccess: 'Signed in',
      loginFail: 'Sign in failed',
      logoutSuccess: 'Signed out',
      registerSuccess: 'Registration successful',
      registerFail: 'Registration failed',
      completeInfo: 'Please complete all fields',
    },
    profile: {
      title: 'User center',
      subtitle: 'Manage your personal info and security preferences.',
      viewOrders: 'View orders',
      manageAddresses: 'Manage addresses',
      totalOrders: 'Total orders',
      pendingOrders: 'Pending orders',
      paidOrders: 'Paid orders',
      shippedOrders: 'Shipped orders',
      completedOrders: 'Completed orders',
      favoriteCount: 'Favorites',
      footprintCount: 'Footprints',
      basicInfo: 'Basic profile',
      basicHint: 'Keep your contact details up to date.',
      roleName: 'Role name',
      createdAt: 'Created at',
      securityTitle: 'Security',
      securityHint: 'Update your account password regularly.',
      oldPassword: 'Current password',
      newPassword: 'New password',
      confirmPassword: 'Confirm password',
      updatePassword: 'Update password',
      passwordUpdated: 'Password updated',
      favoritesTitle: 'Favorites',
      favoritesHint: 'Your saved products for later.',
      noFavorites: 'No favorites yet',
      footprintsTitle: 'Footprints',
      footprintsHint: 'Recently viewed products.',
      noFootprints: 'No footprints yet',
      view: 'View',
      remove: 'Remove',
      removed: 'Removed',
    },
    admin: {
      usersTitle: 'User Management',
      usersSubtitle: 'Search, disable, or reset passwords.',
      rolesTitle: 'Role Management',
      rolesSubtitle: 'Create roles and assign menus or permissions.',
      bannerTitle: 'Banner Management',
      bannerSubtitle: 'Control homepage sliders and jump links.',
      productsTitle: 'Product Control',
      productsSubtitle: 'Manage catalog, pricing, and inventory in one place.',
      categoriesTitle: 'Category Management',
      categoriesSubtitle: 'Organize product groups and visibility.',
      newCategory: 'New Category',
      categoryName: 'Category Name',
      parentId: 'Parent ID',
      cartsTitle: 'Cart Oversight',
      cartsSubtitle: 'Review active carts and remove invalid items.',
      ordersTitle: 'Order Command',
      ordersSubtitle: 'Track order status and ship paid orders.',
      statsTitle: 'Sales Overview',
      statsSubtitle: 'Real-time trends and top sellers.',
      newRole: 'New Role',
      roleKey: 'Role Key',
      roleName: 'Role Name',
      roleSearch: 'Search role key/name',
      assignMenus: 'Assign menus',
      assignMenusHint: 'Select menus and button permissions for this role.',
      deleteRoleConfirm: 'Delete this role?',
      newProduct: 'New Product',
      newBanner: 'New Banner',
      statusEnabled: 'Enabled',
      statusDisabled: 'Disabled',
      linkType: 'Link Type',
      linkTarget: 'Target',
      imageUrl: 'Image URL',
      upload: 'Upload',
      uploadSuccess: 'Upload successful',
      uploadFail: 'Upload failed',
      sort: 'Sort',
      brief: 'Brief',
      coverUrl: 'Cover URL',
      detailHtml: 'Detail HTML',
      exportOrders: 'Export',
      todayOrders: 'Today orders',
      totalSales: 'Total sales',
      topProducts: 'Top products',
      topProductsHint: 'Ranked by total quantity sold.',
      resetPassword: 'Reset',
      disable: 'Disable',
      assignRole: 'Assign role',
      resetConfirm: 'Reset password to default (123456)?',
      disableConfirm: 'Disable this user?',
      deleteConfirm: 'Delete this item?',
      ship: 'Ship',
      shipConfirm: 'Ship this order now?',
    },
    theme: {
      light: 'Light',
      dark: 'Dark',
    },
  },
  zh: {
    nav: {
      home: '首页',
      products: '商品',
      cart: '购物车',
      orders: '订单',
      profile: '个人信息',
      addresses: '地址',
      admin: '后台',
      adminUsers: '用户',
      adminRoles: '角色',
      adminProducts: '商品',
      adminCategories: '分类',
      adminOrders: '订单',
      adminBanners: '轮播图',
      adminCarts: '购物车',
      adminStats: '统计',
      signIn: '登录',
      createAccount: '注册',
      signOut: '退出',
      signedIn: '已登录',
    },
    common: {
      loading: '加载中...',
      empty: '暂无数据',
      search: '搜索',
      reset: '重置',
      save: '保存',
      cancel: '取消',
      create: '新建',
      createdAt: '创建时间',
      delete: '删除',
      edit: '编辑',
      submit: '提交',
      total: '合计',
      manage: '管理',
      status: '状态',
      actions: '操作',
      price: '价格',
      qty: '数量',
      amount: '金额',
      yes: '是',
      no: '否',
      refresh: '刷新',
    },
    home: {
      discover: '探索',
      heroTitle: '让购物像旅行一样有灵感',
      heroSubtitle: '精选分类、快速下单、顺滑支付。',
      browse: '去逛商品',
      viewRecommend: '查看推荐',
      tags: {
        fast: '极速响应',
        secure: '安全支付',
        curated: '精选上新',
      },
      bannerTitle: '焦点轮播',
      noBanners: '暂无轮播图',
      categories: '分类灵感',
      allCategories: '全部分类',
      categoryHint: '精选主题 · 快速浏览',
      recommended: '推荐商品',
      viewAll: '查看全部',
      view: '查看',
    },
    productList: {
      title: '商品探索',
      subtitle: '按分类与关键词筛选，快速找到心仪商品。',
      searchPlaceholder: '搜索关键词',
      categoryPlaceholder: '选择分类',
      stock: '库存',
      noProducts: '暂无商品',
    },
    productDetail: {
      title: '商品详情',
      price: '价格',
      stock: '库存',
      quantity: '数量',
      addToCart: '加入购物车',
      addFavorite: '加入收藏',
      favorited: '已加入收藏',
      back: '返回',
      description: '商品描述',
    },
    cart: {
      title: '购物车',
      subtitle: '提交订单前请核对商品。',
      empty: '购物车为空',
      checkout: '去结算',
      remove: '删除',
      quantity: '数量',
      selectedTotal: '已选合计',
      added: '已加入购物车',
      addFail: '加入购物车失败',
      loadFail: '加载购物车失败',
      updateFail: '更新购物车失败',
      removeSuccess: '已删除',
      removeFail: '删除失败',
    },
    address: {
      title: '收货地址',
      manage: '管理收货信息',
      add: '新增地址',
      receiver: '收货人',
      phone: '手机号',
      province: '省份',
      city: '城市',
      area: '地区',
      detail: '详细地址',
      default: '默认',
      save: '保存',
      delete: '删除',
      setDefault: '设为默认',
      empty: '暂无地址',
    },
    orderConfirm: {
      title: '确认订单',
      subtitle: '选择收货地址并提交订单。',
      items: '商品清单',
      address: '收货地址',
      manageAddress: '管理地址',
      total: '合计',
      submit: '提交订单',
      noItems: '未选择商品',
      selectAddress: '请选择收货地址',
      created: '订单已提交',
      submitFail: '提交订单失败',
      loadFail: '加载确认页失败',
    },
    orderList: {
      title: '我的订单',
      subtitle: '查看订单状态与操作。',
      orderNo: '订单号',
      statusAll: '全部',
      pending: '待支付',
      paid: '待发货',
      shipped: '已发货',
      completed: '已完成',
      pay: '支付',
      confirm: '确认收货',
      noOrders: '暂无订单',
      payConfirm: '确认立即支付？',
      confirmConfirm: '确认收货该订单？',
      paySuccess: '支付成功',
      payFail: '支付失败',
      confirmSuccess: '已确认收货',
      confirmFail: '确认失败',
      loadFail: '加载订单失败',
    },
    auth: {
      loginTitle: '账号登录',
      loginSubtitle: '欢迎回来，请输入账号信息。',
      registerTitle: '注册新账号',
      registerSubtitle: '开始你的购物之旅。',
      username: '用户名',
      phone: '手机号',
      password: '密码',
      confirmPassword: '确认密码',
      login: '登录',
      register: '注册',
      noAccount: '还没有账号？',
      hasAccount: '已有账号？',
      toRegister: '立即注册',
      toLogin: '返回登录',
      loginSuccess: '登录成功',
      loginFail: '登录失败',
      logoutSuccess: '已退出',
      registerSuccess: '注册成功',
      registerFail: '注册失败',
      completeInfo: '请完整填写注册信息',
    },
    profile: {
      title: '用户中心',
      subtitle: '管理你的个人信息与安全设置。',
      viewOrders: '查看订单',
      manageAddresses: '管理地址',
      totalOrders: '订单总数',
      pendingOrders: '待支付',
      paidOrders: '待发货',
      shippedOrders: '已发货',
      completedOrders: '已完成',
      favoriteCount: '收藏',
      footprintCount: '足迹',
      basicInfo: '基础信息',
      basicHint: '保持联系方式为最新。',
      roleName: '角色名称',
      createdAt: '创建时间',
      securityTitle: '安全设置',
      securityHint: '定期更新密码保障账号安全。',
      oldPassword: '当前密码',
      newPassword: '新密码',
      confirmPassword: '确认密码',
      updatePassword: '更新密码',
      passwordUpdated: '密码已更新',
      favoritesTitle: '收藏夹',
      favoritesHint: '你保存的商品。',
      noFavorites: '暂无收藏',
      footprintsTitle: '浏览足迹',
      footprintsHint: '最近浏览的商品。',
      noFootprints: '暂无足迹',
      view: '查看',
      remove: '移除',
      removed: '已移除',
    },
    admin: {
      usersTitle: '用户管理',
      usersSubtitle: '搜索、禁用和重置密码。',
      rolesTitle: '角色管理',
      rolesSubtitle: '创建角色并分配菜单与权限。',
      bannerTitle: '轮播图管理',
      bannerSubtitle: '配置轮播图与跳转链接。',
      productsTitle: '商品管理',
      productsSubtitle: '管理商品、价格与库存。',
      categoriesTitle: '分类管理',
      categoriesSubtitle: '维护商品分类与显示状态。',
      newCategory: '新增分类',
      categoryName: '分类名称',
      parentId: '父级ID',
      cartsTitle: '购物车管理',
      cartsSubtitle: '查看购物车并清理无效项。',
      ordersTitle: '订单管理',
      ordersSubtitle: '查看订单并发货。',
      statsTitle: '销售概览',
      statsSubtitle: '实时趋势与热销排行。',
      newRole: '新增角色',
      roleKey: '角色标识',
      roleName: '角色名称',
      roleSearch: '搜索角色标识/名称',
      assignMenus: '分配菜单',
      assignMenusHint: '选择该角色可访问的菜单与按钮权限。',
      deleteRoleConfirm: '确认删除该角色？',
      newProduct: '新增商品',
      newBanner: '新增轮播',
      statusEnabled: '启用',
      statusDisabled: '禁用',
      linkType: '跳转类型',
      linkTarget: '跳转目标',
      imageUrl: '图片地址',
      upload: '上传',
      uploadSuccess: '上传成功',
      uploadFail: '上传失败',
      sort: '排序',
      brief: '简介',
      coverUrl: '封面地址',
      detailHtml: '详情内容',
      exportOrders: '导出',
      todayOrders: '今日订单',
      totalSales: '总销售额',
      topProducts: '热销商品',
      topProductsHint: '按销量排序。',
      resetPassword: '重置密码',
      disable: '禁用',
      assignRole: '分配角色',
      resetConfirm: '确认重置为默认密码 123456？',
      disableConfirm: '确认禁用该用户？',
      deleteConfirm: '确认删除该记录？',
      ship: '发货',
      shipConfirm: '确认发货该订单？',
    },
    theme: {
      light: '浅色',
      dark: '深色',
    },
  },
}

const setLocale = (value) => {
  locale.value = value
  if (typeof window !== 'undefined') {
    localStorage.setItem('locale', value)
    document.documentElement.lang = value === 'zh' ? 'zh-CN' : 'en'
  }
}

const t = (key) => {
  const segments = key.split('.')
  let result = messages[locale.value]
  for (const segment of segments) {
    if (!result || typeof result !== 'object') {
      return key
    }
    result = result[segment]
  }
  return result ?? key
}

const availableLocales = computed(() => [
  { label: 'EN', value: 'en' },
  { label: '中文', value: 'zh' },
])

export const useI18n = () => ({
  locale,
  setLocale,
  t,
  availableLocales,
})
